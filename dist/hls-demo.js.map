{"version":3,"sources":["webpack://HlsDemo/webpack/universalModuleDefinition","webpack://HlsDemo/webpack/bootstrap","webpack://HlsDemo/./demo/demo-utils.js","webpack://HlsDemo/./demo/main.js","webpack://HlsDemo/./tests/test-streams.js"],"names":["sortObject","obj","temp","keys","key","push","sort","index","copyTextToClipboard","text","textArea","document","createElement","value","body","appendChild","select","successful","execCommand","msg","console","log","err","removeChild","STORAGE_KEYS","Editor_Persistence","Hls_Config","testStreams","require","defaultTestStreamUrl","url","sourceURL","decodeURIComponent","getURLParam","demoConfig","JSON","parse","atob","hlsjsDefaults","debug","enableWorker","liveBackBufferLength","enableStreaming","getDemoConfigPropOrDefault","autoRecoverError","levelCapping","limitMetrics","dumpfMP4","bufferingIdx","selectedTestStream","video","$","startTime","Date","now","lastSeekingIdx","lastStartPosition","lastDuration","lastAudioTrackSwitchingIdx","hls","events","stats","tracks","fmp4Data","configPersistenceEnabled","ready","Object","forEach","stream","option","Option","description","append","change","val","streamUrl","loadSelectedStream","width","volume","toggle","window","windowSliding","setupGlobals","t0","performance","load","buffer","level","bitrate","recoverDecodingErrorDate","recoverSwapAudioCodecDate","onClickBufferedRange","updateLevelInfo","trimArray","target","limit","length","shift","trimEventHistory","x","Hls","isSupported","handleUnsupported","hideCanvas","destroy","bufferTimer","clearInterval","undefined","logStatus","hlsConfig","extend","config","info","onDemoConfigChanged","loadSource","autoLevelCapping","attachMedia","on","Events","MEDIA_ATTACHED","time","type","MEDIA_DETACHED","FRAG_PARSING_INIT_SEGMENT","name","data","showCanvas","id","FRAG_PARSING_METADATA","LEVEL_SWITCHING","Math","round","levels","MANIFEST_PARSED","start","end","trequest","latency","tfirst","tload","duration","refreshCanvas","levelNb","levelParsed","AUDIO_TRACKS_UPDATED","audioTracks","updateAudioTrackInfo","AUDIO_TRACK_SWITCHING","AUDIO_TRACK_SWITCHED","event","LEVEL_LOADED","isLive","details","live","startSN","endSN","parsing","tparsed","parsingDuration","sumLevelParsingMs","levelParsingUs","AUDIO_TRACK_LOADED","FRAG_BUFFERED","frag","id2","sn","tbuffered","bw","total","size","pos","setInterval","checkBuffer","process","fragBuffered","fragMinLatency","min","fragMaxLatency","max","fragMinProcess","fragMaxProcess","fragMinKbps","fragMaxKbps","autoLevelCappingMin","autoLevelCappingMax","fragBufferedBytes","sumLatency","sumKbps","sumProcess","sumParsing","fraglastLatency","fragAvgLatency","fragLastProcess","fragAvgProcess","fragLastKbps","fragAvgKbps","fragparsingKbps","fragparsingMs","autoLevelCappingLast","LEVEL_SWITCHED","FRAG_CHANGED","tagList","autoLevel","levelStart","fragChangedAuto","autoLevelMin","autoLevelMax","levelLastAuto","autoLevelLast","autoLevelSwitch","sumAutoLevel","autoLevelAvg","fragChangedManual","manualLevelMin","manualLevelMax","manualLevelLast","manualLevelSwitch","FRAG_LOAD_EMERGENCY_ABORTED","fragLoadEmergencyAborted","FRAG_DECRYPTED","fragDecrypted","totalDecryptTime","fragAvgDecryptTime","tdecrypt","tstart","ERROR","warn","ErrorDetails","MANIFEST_LOAD_ERROR","html","context","response","code","MANIFEST_LOAD_TIMEOUT","logError","MANIFEST_PARSING_ERROR","reason","LEVEL_EMPTY_ERROR","handleLevelError","LEVEL_LOAD_ERROR","LEVEL_LOAD_TIMEOUT","LEVEL_SWITCH_ERROR","FRAG_LOAD_ERROR","FRAG_LOAD_TIMEOUT","FRAG_LOOP_LOADING_ERROR","FRAG_DECRYPT_ERROR","FRAG_PARSING_ERROR","KEY_LOAD_ERROR","decryptdata","uri","KEY_LOAD_TIMEOUT","BUFFER_APPEND_ERROR","BUFFER_ADD_CODEC_ERROR","mimeType","message","BUFFER_APPENDING_ERROR","BUFFER_STALLED_ERROR","fatal","error","ErrorTypes","MEDIA_ERROR","handleMediaError","NETWORK_ERROR","fatalError","stringify","BUFFER_CREATED","BUFFER_APPENDING","FPS_DROP","evt","currentDropped","currentDecoded","fpsDropEvent","fpsTotalDroppedFrames","totalDroppedFrames","addEventListener","handleVideoEvent","navigator","userAgent","toLowerCase","indexOf","videoWidth","videoHeight","currentTime","errorTxt","mediaError","currentTarget","MEDIA_ERR_ABORTED","MEDIA_ERR_DECODE","MEDIA_ERR_NETWORK","MEDIA_ERR_SRC_NOT_SUPPORTED","levelObj","removeLevel","urlId","currentLevel","recoverMediaError","swapAudioCodec","timeRangesToString","r","i","v","canvas","ctx","getContext","buffered","bufferingDuration","fillStyle","fillRect","height","clientWidth","bufferLen","paused","bufEvents","bufEventLen","event0","event1","slopeBuf0","slopeBuf1","slopePos0","slopePos1","abs","pop","seekable","played","media","videoPlaybackQuality","getVideoPlaybackQuality","Function","droppedVideoFrames","corruptedVideoFrames","webkitDroppedFrameCount","showMetrics","show","hideMetrics","hide","getMetrics","json","jsonpacked","jsonpack","pack","btoa","copyMetricsToClipBoard","goToMetrics","URL","substr","lastIndexOf","open","goToMetricsPermaLink","b64","minsecs","ts","m","floor","s","clientX","offsetLeft","button_template","button_enabled","button_disabled","html1","autoLevelEnabled","html2","html3","html4","levelName","label","level2label","loadLevel","nextLevel","audioTrackId","audioTrack","len","propName","defaultVal","sParam","defaultValue","sPageURL","location","search","substring","sURLVariables","split","sParameterName","persistEditorValue","serializedDemoConfig","baseURL","streamURL","permalinkURL","encodeURIComponent","onConfigPersistenceChanged","checked","localStorage","setItem","removeItem","getPersistedHlsConfig","getItem","e","arrayConcat","inputArray","totalLength","reduce","prev","cur","result","Uint8Array","offset","element","set","appendLog","textElId","el","logText","timestamp","newMessage","createTestStream","abr","blacklist_ua","createTestStreamWithConfig","Error","testStream","module","exports","bbb","nudgeMaxRetry","borat","LabScreenCap1","LabScreenCap2"],"mappings":"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","file":"hls-demo.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"HlsDemo\"] = factory();\n\telse\n\t\troot[\"HlsDemo\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./demo/main.js\");\n","export function sortObject (obj) {\n  if (typeof obj !== 'object') {\n    return obj;\n  }\n  let temp = {};\n  let keys = [];\n  for (let key in obj) {\n    keys.push(key);\n  }\n  keys.sort();\n  for (let index in keys) {\n    temp[keys[index]] = sortObject(obj[keys[index]]);\n  }\n  return temp;\n}\n\nexport function copyTextToClipboard (text) {\n  let textArea = document.createElement('textarea');\n  textArea.value = text;\n  document.body.appendChild(textArea);\n  textArea.select();\n  try {\n    let successful = document.execCommand('copy');\n    let msg = successful ? 'successful' : 'unsuccessful';\n    console.log('Copying text command was ' + msg);\n  } catch (err) {\n    console.log('Oops, unable to copy');\n  }\n  document.body.removeChild(textArea);\n}\n","/* global $, Hls */\n/* eslint camelcase: 0 */\n\nimport { sortObject, copyTextToClipboard } from './demo-utils';\n\nconst STORAGE_KEYS = {\n  Editor_Persistence: 'hlsjs:config-editor-persist',\n  Hls_Config: 'hlsjs:config'\n};\n\nconst testStreams = require('../tests/test-streams');\nconst defaultTestStreamUrl = testStreams['bbb'].url;\nconst sourceURL = decodeURIComponent(getURLParam('src', defaultTestStreamUrl));\n\nlet demoConfig = getURLParam('demoConfig', null);\nif (demoConfig) {\n  demoConfig = JSON.parse(atob(demoConfig));\n} else {\n  demoConfig = {};\n}\n\nconst hlsjsDefaults = {\n  debug: true,\n  enableWorker: true,\n  liveBackBufferLength: 60 * 15\n};\n\nlet enableStreaming = getDemoConfigPropOrDefault('enableStreaming', true);\nlet autoRecoverError = getDemoConfigPropOrDefault('autoRecoverError', true);\nlet levelCapping = getDemoConfigPropOrDefault('levelCapping', -1);\nlet limitMetrics = getDemoConfigPropOrDefault('limitMetrics', -1);\nlet dumpfMP4 = getDemoConfigPropOrDefault('dumpfMP4', false);\n\nlet bufferingIdx = -1;\nlet selectedTestStream = null;\nlet video = $('#video')[0];\nlet startTime = Date.now();\n\nlet lastSeekingIdx;\nlet lastStartPosition;\nlet lastDuration;\nlet lastAudioTrackSwitchingIdx;\nlet hls;\nlet url;\nlet events;\nlet stats;\nlet tracks;\nlet fmp4Data;\nlet configPersistenceEnabled = false;\n\n$(document).ready(function () {\n\n  Object.keys(testStreams).forEach((key) => {\n    const stream = testStreams[key];\n    const option = new Option(stream.description, key);\n    $('#streamSelect').append(option);\n  });\n\n  $('#streamSelect').change(function () {\n    selectedTestStream = testStreams[$('#streamSelect').val()];\n    const streamUrl = selectedTestStream.url;\n    $('#streamURL').val(streamUrl);\n    loadSelectedStream();\n  });\n\n  $('#streamURL').change(function () {\n    selectedTestStream = null;\n    loadSelectedStream();\n  });\n\n  $('#videoSize').change(function () {\n    $('#video').width($('#videoSize').val());\n    $('#bufferedCanvas').width($('#videoSize').val());\n  });\n\n  $('#streamURL').val(sourceURL);\n\n  video.volume = 0.05;\n\n  $('#metricsButtonWindow').toggle(window.windowSliding);\n  $('#metricsButtonFixed').toggle(!window.windowSliding);\n\n  loadSelectedStream();\n});\n\nfunction setupGlobals () {\n  window.events = events = {\n    url: url,\n    t0: performance.now(),\n    load: [],\n    buffer: [],\n    video: [],\n    level: [],\n    bitrate: []\n  };\n\n  // actual values, only on window\n  window.recoverDecodingErrorDate = null;\n  window.recoverSwapAudioCodecDate = null;\n\n  window.fmp4Data = fmp4Data = {\n    'audio': [],\n    'video': []\n  };\n\n  window.onClickBufferedRange = onClickBufferedRange;\n\n  window.updateLevelInfo = updateLevelInfo;\n}\n\nfunction trimArray (target, limit) {\n  if (limit < 0) {\n    return;\n  }\n\n  while (target.length > limit) {\n    target.shift();\n  }\n}\n\nfunction trimEventHistory () {\n  const x = limitMetrics;\n\n  if (x < 0) {\n    return;\n  }\n\n  trimArray(events.load, x);\n  trimArray(events.buffer, x);\n  trimArray(events.video, x);\n  trimArray(events.level, x);\n  trimArray(events.bitrate, x);\n}\n\nfunction loadSelectedStream () {\n  if (!Hls.isSupported()) {\n    handleUnsupported();\n    return;\n  }\n\n  url = $('#streamURL').val();\n\n  setupGlobals();\n  hideCanvas();\n\n  if (hls) {\n    hls.destroy();\n    if (hls.bufferTimer) {\n      clearInterval(hls.bufferTimer);\n      hls.bufferTimer = undefined;\n    }\n    hls = null;\n  }\n\n  logStatus('Loading ' + url);\n\n  // Extending both a demo-specific config and the user config which can override all\n  const hlsConfig = $.extend({}, hlsjsDefaults);\n\n  if (selectedTestStream && selectedTestStream.config) {\n    console.info('[loadSelectedStream] extending hls config with stream-specific config: ', selectedTestStream.config);\n    $.extend(hlsConfig, selectedTestStream.config);\n  }\n\n  onDemoConfigChanged();\n  console.log('Using Hls.js config:', hlsConfig);\n\n  window.hls = hls = new Hls(hlsConfig);\n\n  logStatus('Loading manifest and attaching video element...');\n\n  hls.loadSource(url);\n  hls.autoLevelCapping = levelCapping;\n  hls.attachMedia(video);\n\n  hls.on(Hls.Events.MEDIA_ATTACHED, function () {\n    logStatus('Media element attached');\n    bufferingIdx = -1;\n    events.video.push({\n      time: performance.now() - events.t0,\n      type: 'Media attached'\n    });\n    trimEventHistory();\n  });\n\n  hls.on(Hls.Events.MEDIA_DETACHED, function () {\n    logStatus('Media element detached');\n    bufferingIdx = -1;\n    tracks = [];\n    events.video.push({\n      time: performance.now() - events.t0,\n      type: 'Media detached'\n    });\n    trimEventHistory();\n  });\n\n  hls.on(Hls.Events.FRAG_PARSING_INIT_SEGMENT, function (name, data) {\n    showCanvas();\n    events.video.push({\n      time: performance.now() - events.t0,\n      type: data.id + ' init segment'\n    });\n    trimEventHistory();\n  });\n\n  hls.on(Hls.Events.FRAG_PARSING_METADATA, function (name, data) {\n    // console.log(\"Id3 samples \", data.samples);\n  });\n\n  hls.on(Hls.Events.LEVEL_SWITCHING, function (name, data) {\n    events.level.push({\n      time: performance.now() - events.t0,\n      id: data.level,\n      bitrate: Math.round(hls.levels[data.level].bitrate / 1000)\n    });\n    trimEventHistory();\n    updateLevelInfo();\n  });\n\n  hls.on(Hls.Events.MANIFEST_PARSED, function (name, data) {\n    events.load.push({\n      type: 'manifest',\n      name: '',\n      start: 0,\n      end: data.levels.length,\n      time: data.stats.trequest - events.t0,\n      latency: data.stats.tfirst - data.stats.trequest,\n      load: data.stats.tload - data.stats.tfirst,\n      duration: data.stats.tload - data.stats.tfirst\n    });\n    trimEventHistory();\n    window.refreshCanvas();\n  });\n\n  hls.on(Hls.Events.MANIFEST_PARSED, function (name, data) {\n    logStatus('No of quality levels found: ' + hls.levels.length);\n    logStatus('Manifest successfully loaded');\n    stats = {\n      levelNb: data.levels.length,\n      levelParsed: 0\n    };\n    trimEventHistory();\n    updateLevelInfo();\n  });\n\n  hls.on(Hls.Events.AUDIO_TRACKS_UPDATED, function (name, data) {\n    logStatus('No of audio tracks found: ' + data.audioTracks.length);\n    updateAudioTrackInfo();\n  });\n\n  hls.on(Hls.Events.AUDIO_TRACK_SWITCHING, function (name, data) {\n    logStatus('Audio track switching...');\n    updateAudioTrackInfo();\n    events.video.push({\n      time: performance.now() - events.t0,\n      type: 'audio switching',\n      name: '@' + data.id\n    });\n    trimEventHistory();\n    lastAudioTrackSwitchingIdx = events.video.length - 1;\n  });\n\n  hls.on(Hls.Events.AUDIO_TRACK_SWITCHED, function (name, data) {\n    logStatus('Audio track switched');\n    updateAudioTrackInfo();\n    var event = {\n      time: performance.now() - events.t0,\n      type: 'audio switched',\n      name: '@' + data.id\n    };\n    if (lastAudioTrackSwitchingIdx !== undefined) {\n      events.video[lastAudioTrackSwitchingIdx].duration = event.time - events.video[lastAudioTrackSwitchingIdx].time;\n      lastAudioTrackSwitchingIdx = undefined;\n    }\n    events.video.push(event);\n    trimEventHistory();\n  });\n\n  hls.on(Hls.Events.LEVEL_LOADED, function (name, data) {\n    events.isLive = data.details.live;\n    var event = {\n      type: 'level',\n      id: data.level,\n      start: data.details.startSN,\n      end: data.details.endSN,\n      time: data.stats.trequest - events.t0,\n      latency: data.stats.tfirst - data.stats.trequest,\n      load: data.stats.tload - data.stats.tfirst,\n      parsing: data.stats.tparsed - data.stats.tload,\n      duration: data.stats.tload - data.stats.tfirst\n    };\n    const parsingDuration = data.stats.tparsed - data.stats.tload;\n    if (stats.levelParsed) {\n      this.sumLevelParsingMs += parsingDuration;\n    } else {\n      this.sumLevelParsingMs = parsingDuration;\n    }\n\n    stats.levelParsed++;\n    stats.levelParsingUs = Math.round(1000 * this.sumLevelParsingMs / stats.levelParsed);\n\n    // console.log('parsing level duration :' + stats.levelParsingUs + 'us,count:' + stats.levelParsed);\n\n    events.load.push(event);\n    trimEventHistory();\n    window.refreshCanvas();\n  });\n\n  hls.on(Hls.Events.AUDIO_TRACK_LOADED, function (name, data) {\n    events.isLive = data.details.live;\n    var event = {\n      type: 'audio track',\n      id: data.id,\n      start: data.details.startSN,\n      end: data.details.endSN,\n      time: data.stats.trequest - events.t0,\n      latency: data.stats.tfirst - data.stats.trequest,\n      load: data.stats.tload - data.stats.tfirst,\n      parsing: data.stats.tparsed - data.stats.tload,\n      duration: data.stats.tload - data.stats.tfirst\n    };\n    events.load.push(event);\n    trimEventHistory();\n    window.refreshCanvas();\n  });\n\n  hls.on(Hls.Events.FRAG_BUFFERED, function (name, data) {\n    var event = {\n      type: data.frag.type + ' fragment',\n      id: data.frag.level,\n      id2: data.frag.sn,\n      time: data.stats.trequest - events.t0,\n      latency: data.stats.tfirst - data.stats.trequest,\n      load: data.stats.tload - data.stats.tfirst,\n      parsing: data.stats.tparsed - data.stats.tload,\n      buffer: data.stats.tbuffered - data.stats.tparsed,\n      duration: data.stats.tbuffered - data.stats.tfirst,\n      bw: Math.round(8 * data.stats.total / (data.stats.tbuffered - data.stats.trequest)),\n      size: data.stats.total\n    };\n    events.load.push(event);\n    events.bitrate.push({\n      time: performance.now() - events.t0,\n      bitrate: event.bw,\n      duration: data.frag.duration,\n      level: event.id\n    });\n    if (hls.bufferTimer === undefined) {\n      events.buffer.push({\n        time: 0,\n        buffer: 0,\n        pos: 0\n      });\n      hls.bufferTimer = window.setInterval(checkBuffer, 100);\n    }\n    trimEventHistory();\n    window.refreshCanvas();\n    updateLevelInfo();\n\n    let latency = data.stats.tfirst - data.stats.trequest;\n    let parsing = data.stats.tparsed - data.stats.tload;\n    let process = data.stats.tbuffered - data.stats.trequest;\n    let bitrate = Math.round(8 * data.stats.length / (data.stats.tbuffered - data.stats.tfirst));\n    if (stats.fragBuffered) {\n      stats.fragMinLatency = Math.min(stats.fragMinLatency, latency);\n      stats.fragMaxLatency = Math.max(stats.fragMaxLatency, latency);\n      stats.fragMinProcess = Math.min(stats.fragMinProcess, process);\n      stats.fragMaxProcess = Math.max(stats.fragMaxProcess, process);\n      stats.fragMinKbps = Math.min(stats.fragMinKbps, bitrate);\n      stats.fragMaxKbps = Math.max(stats.fragMaxKbps, bitrate);\n      stats.autoLevelCappingMin = Math.min(stats.autoLevelCappingMin, hls.autoLevelCapping);\n      stats.autoLevelCappingMax = Math.max(stats.autoLevelCappingMax, hls.autoLevelCapping);\n      stats.fragBuffered++;\n    } else {\n      stats.fragMinLatency = stats.fragMaxLatency = latency;\n      stats.fragMinProcess = stats.fragMaxProcess = process;\n      stats.fragMinKbps = stats.fragMaxKbps = bitrate;\n      stats.fragBuffered = 1;\n      stats.fragBufferedBytes = 0;\n      stats.autoLevelCappingMin = stats.autoLevelCappingMax = hls.autoLevelCapping;\n      this.sumLatency = 0;\n      this.sumKbps = 0;\n      this.sumProcess = 0;\n      this.sumParsing = 0;\n    }\n    stats.fraglastLatency = latency;\n    this.sumLatency += latency;\n    stats.fragAvgLatency = Math.round(this.sumLatency / stats.fragBuffered);\n    stats.fragLastProcess = process;\n    this.sumProcess += process;\n    this.sumParsing += parsing;\n    stats.fragAvgProcess = Math.round(this.sumProcess / stats.fragBuffered);\n    stats.fragLastKbps = bitrate;\n    this.sumKbps += bitrate;\n    stats.fragAvgKbps = Math.round(this.sumKbps / stats.fragBuffered);\n    stats.fragBufferedBytes += data.stats.total;\n    stats.fragparsingKbps = Math.round(8 * stats.fragBufferedBytes / this.sumParsing);\n    stats.fragparsingMs = Math.round(this.sumParsing);\n    stats.autoLevelCappingLast = hls.autoLevelCapping;\n  });\n\n  hls.on(Hls.Events.LEVEL_SWITCHED, function (name, data) {\n    var event = {\n      time: performance.now() - events.t0,\n      type: 'level switched',\n      name: data.level\n    };\n    events.video.push(event);\n    trimEventHistory();\n    window.refreshCanvas();\n    updateLevelInfo();\n  });\n\n  hls.on(Hls.Events.FRAG_CHANGED, function (name, data) {\n    var event = {\n      time: performance.now() - events.t0,\n      type: 'frag changed',\n      name: data.frag.sn + ' @ ' + data.frag.level\n    };\n    events.video.push(event);\n    trimEventHistory();\n    window.refreshCanvas();\n    updateLevelInfo();\n    stats.tagList = data.frag.tagList;\n\n    let level = data.frag.level; let autoLevel = data.frag.autoLevel;\n    if (stats.levelStart === undefined) {\n      stats.levelStart = level;\n    }\n\n    if (autoLevel) {\n      if (stats.fragChangedAuto) {\n        stats.autoLevelMin = Math.min(stats.autoLevelMin, level);\n        stats.autoLevelMax = Math.max(stats.autoLevelMax, level);\n        stats.fragChangedAuto++;\n        if (this.levelLastAuto && level !== stats.autoLevelLast) {\n          stats.autoLevelSwitch++;\n        }\n      } else {\n        stats.autoLevelMin = stats.autoLevelMax = level;\n        stats.autoLevelSwitch = 0;\n        stats.fragChangedAuto = 1;\n        this.sumAutoLevel = 0;\n      }\n      this.sumAutoLevel += level;\n      stats.autoLevelAvg = Math.round(1000 * this.sumAutoLevel / stats.fragChangedAuto) / 1000;\n      stats.autoLevelLast = level;\n    } else {\n      if (stats.fragChangedManual) {\n        stats.manualLevelMin = Math.min(stats.manualLevelMin, level);\n        stats.manualLevelMax = Math.max(stats.manualLevelMax, level);\n        stats.fragChangedManual++;\n        if (!this.levelLastAuto && level !== stats.manualLevelLast) {\n          stats.manualLevelSwitch++;\n        }\n      } else {\n        stats.manualLevelMin = stats.manualLevelMax = level;\n        stats.manualLevelSwitch = 0;\n        stats.fragChangedManual = 1;\n      }\n      stats.manualLevelLast = level;\n    }\n    this.levelLastAuto = autoLevel;\n  });\n\n  hls.on(Hls.Events.FRAG_LOAD_EMERGENCY_ABORTED, function (name, data) {\n    if (stats) {\n      if (stats.fragLoadEmergencyAborted === undefined) {\n        stats.fragLoadEmergencyAborted = 1;\n      } else {\n        stats.fragLoadEmergencyAborted++;\n      }\n    }\n  });\n\n  hls.on(Hls.Events.FRAG_DECRYPTED, function (name, data) {\n    if (!stats.fragDecrypted) {\n      stats.fragDecrypted = 0;\n      this.totalDecryptTime = 0;\n      stats.fragAvgDecryptTime = 0;\n    }\n    stats.fragDecrypted++;\n    this.totalDecryptTime += data.stats.tdecrypt - data.stats.tstart;\n    stats.fragAvgDecryptTime = this.totalDecryptTime / stats.fragDecrypted;\n  });\n\n  hls.on(Hls.Events.ERROR, function (name, data) {\n    console.warn('Error event:', data);\n    switch (data.details) {\n    case Hls.ErrorDetails.MANIFEST_LOAD_ERROR:\n      try {\n        $('#errorOut').html('Cannot load <a href=\"' + data.context.url + '\">' + url + '</a><br>HTTP response code:' + data.response.code + ' <br>' + data.response.text);\n        if (data.response.code === 0) {\n          $('#errorOut').append('This might be a CORS issue, consider installing <a href=\"https://chrome.google.com/webstore/detail/allow-control-allow-origi/nlfbmbojpeacfghkpbjhddihlkkiljbi\">Allow-Control-Allow-Origin</a> Chrome Extension');\n        }\n      } catch (err) {\n        $('#errorOut').html('Cannot load <a href=\"' + data.context.url + '\">' + url + '</a><br>Response body: ' + data.response.text);\n      }\n      break;\n    case Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT:\n      logError('Timeout while loading manifest');\n      break;\n    case Hls.ErrorDetails.MANIFEST_PARSING_ERROR:\n      logError('Error while parsing manifest:' + data.reason);\n      break;\n    case Hls.ErrorDetails.LEVEL_EMPTY_ERROR:\n      logError('Loaded level contains no fragments ' + data.level + ' ' + data.url);\n      handleLevelError(data);\n      break;\n    case Hls.ErrorDetails.LEVEL_LOAD_ERROR:\n      logError('Error while loading level playlist ' + data.context.level + ' ' + data.url);\n      handleLevelError(data);\n      break;\n    case Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT:\n      logError('Timeout while loading level playlist ' + data.context.level + ' ' + data.url);\n      handleLevelError(data);\n      break;\n    case Hls.ErrorDetails.LEVEL_SWITCH_ERROR:\n      logError('Error while trying to switch to level ' + data.level);\n      break;\n    case Hls.ErrorDetails.FRAG_LOAD_ERROR:\n      logError('Error while loading fragment ' + data.frag.url);\n      break;\n    case Hls.ErrorDetails.FRAG_LOAD_TIMEOUT:\n      logError('Timeout while loading fragment ' + data.frag.url);\n      break;\n    case Hls.ErrorDetails.FRAG_LOOP_LOADING_ERROR:\n      logError('Fragment-loop loading error');\n      break;\n    case Hls.ErrorDetails.FRAG_DECRYPT_ERROR:\n      logError('Decrypting error:' + data.reason);\n      break;\n    case Hls.ErrorDetails.FRAG_PARSING_ERROR:\n      logError('Parsing error:' + data.reason);\n      break;\n    case Hls.ErrorDetails.KEY_LOAD_ERROR:\n      logError('Error while loading key ' + data.frag.decryptdata.uri);\n      break;\n    case Hls.ErrorDetails.KEY_LOAD_TIMEOUT:\n      logError('Timeout while loading key ' + data.frag.decryptdata.uri);\n      break;\n    case Hls.ErrorDetails.BUFFER_APPEND_ERROR:\n      logError('Buffer append error');\n      break;\n    case Hls.ErrorDetails.BUFFER_ADD_CODEC_ERROR:\n      logError('Buffer add codec error for ' + data.mimeType + ':' + data.err.message);\n      break;\n    case Hls.ErrorDetails.BUFFER_APPENDING_ERROR:\n      logError('Buffer appending error');\n      break;\n    case Hls.ErrorDetails.BUFFER_STALLED_ERROR:\n      logError('Buffer stalled error');\n      break;\n    default:\n      break;\n    }\n    if (data.fatal) {\n      console.error('Fatal error :' + data.details);\n      switch (data.type) {\n      case Hls.ErrorTypes.MEDIA_ERROR:\n        handleMediaError();\n        break;\n      case Hls.ErrorTypes.NETWORK_ERROR:\n        logError('A network error occurred');\n        break;\n      default:\n        logError('An unrecoverable error occurred');\n        hls.destroy();\n        break;\n      }\n    }\n    if (!stats) {\n      stats = {};\n    }\n    // track all errors independently\n    if (stats[data.details] === undefined) {\n      stats[data.details] = 1;\n    } else {\n      stats[data.details] += 1;\n    }\n\n    // track fatal error\n    if (data.fatal) {\n      if (stats.fatalError === undefined) {\n        stats.fatalError = 1;\n      } else {\n        stats.fatalError += 1;\n      }\n    }\n    $('#statisticsOut').text(JSON.stringify(sortObject(stats), null, '\\t'));\n  });\n\n  hls.on(Hls.Events.BUFFER_CREATED, function (name, data) {\n    tracks = data.tracks;\n  });\n\n  hls.on(Hls.Events.BUFFER_APPENDING, function (name, data) {\n    if (dumpfMP4) {\n      fmp4Data[data.type].push(data.data);\n    }\n  });\n\n  hls.on(Hls.Events.FPS_DROP, function (name, data) {\n    let evt = {\n      time: performance.now() - events.t0,\n      type: 'frame drop',\n      name: data.currentDropped + '/' + data.currentDecoded\n    };\n    events.video.push(evt);\n    trimEventHistory();\n    if (stats) {\n      if (stats.fpsDropEvent === undefined) {\n        stats.fpsDropEvent = 1;\n      } else {\n        stats.fpsDropEvent++;\n      }\n\n      stats.fpsTotalDroppedFrames = data.totalDroppedFrames;\n    }\n  });\n\n  video.addEventListener('resize', handleVideoEvent);\n  video.addEventListener('seeking', handleVideoEvent);\n  video.addEventListener('seeked', handleVideoEvent);\n  video.addEventListener('pause', handleVideoEvent);\n  video.addEventListener('play', handleVideoEvent);\n  video.addEventListener('canplay', handleVideoEvent);\n  video.addEventListener('canplaythrough', handleVideoEvent);\n  video.addEventListener('ended', handleVideoEvent);\n  video.addEventListener('playing', handleVideoEvent);\n  video.addEventListener('error', handleVideoEvent);\n  video.addEventListener('loadedmetadata', handleVideoEvent);\n  video.addEventListener('loadeddata', handleVideoEvent);\n  video.addEventListener('durationchange', handleVideoEvent);\n}\n\nfunction handleUnsupported () {\n  if (navigator.userAgent.toLowerCase().indexOf('firefox') !== -1) {\n    logStatus('You are using Firefox, it looks like MediaSource is not enabled,<br>please ensure the following keys are set appropriately in <b>about:config</b><br>media.mediasource.enabled=true<br>media.mediasource.mp4.enabled=true<br><b>media.mediasource.whitelist=false</b>');\n  } else {\n    logStatus('Your Browser does not support MediaSourceExtension / MP4 mediasource');\n  }\n}\n\nfunction handleVideoEvent (evt) {\n  let data = '';\n  switch (evt.type) {\n  case 'durationchange':\n    if (evt.target.duration - lastDuration <= 0.5) {\n      // some browsers report several duration change events with almost the same value ... avoid spamming video events\n      return;\n    }\n    lastDuration = evt.target.duration;\n    data = Math.round(evt.target.duration * 1000);\n    break;\n  case 'resize':\n    data = evt.target.videoWidth + '/' + evt.target.videoHeight;\n    break;\n  case 'loadedmetadata':\n  case 'loadeddata':\n  case 'canplay':\n  case 'canplaythrough':\n  case 'ended':\n  case 'seeking':\n  case 'seeked':\n  case 'play':\n  case 'playing':\n    lastStartPosition = evt.target.currentTime;\n  case 'pause':\n  case 'waiting':\n  case 'stalled':\n  case 'error':\n    data = Math.round(evt.target.currentTime * 1000);\n    if (evt.type === 'error') {\n      let errorTxt; let mediaError = evt.currentTarget.error;\n      switch (mediaError.code) {\n      case mediaError.MEDIA_ERR_ABORTED:\n        errorTxt = 'You aborted the video playback';\n        break;\n      case mediaError.MEDIA_ERR_DECODE:\n        errorTxt = 'The video playback was aborted due to a corruption problem or because the video used features your browser did not support';\n        handleMediaError();\n        break;\n      case mediaError.MEDIA_ERR_NETWORK:\n        errorTxt = 'A network error caused the video download to fail part-way';\n        break;\n      case mediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:\n        errorTxt = 'The video could not be loaded, either because the server or network failed or because the format is not supported';\n        break;\n      }\n\n      if (mediaError.message) {\n        errorTxt += ' - ' + mediaError.message;\n      }\n\n      logStatus(errorTxt);\n      console.error(errorTxt);\n    }\n    break;\n  default:\n    break;\n  }\n\n  let event = {\n    time: performance.now() - events.t0,\n    type: evt.type,\n    name: data\n  };\n\n  events.video.push(event);\n  if (evt.type === 'seeking') {\n    lastSeekingIdx = events.video.length - 1;\n  }\n\n  if (evt.type === 'seeked') {\n    events.video[lastSeekingIdx].duration = event.time - events.video[lastSeekingIdx].time;\n  }\n\n  trimEventHistory();\n}\n\nfunction handleLevelError (data) {\n  var levelObj = data.context || data;\n  hls.removeLevel(levelObj.level, levelObj.urlId || 0);\n  if (!hls.levels.length) {\n    logError('All levels have been removed');\n    hls.destroy();\n    return;\n  }\n  // Trigger an immediate downswitch to the first level\n  // This is to handle the case where we start at an empty level, where switching to auto causes hlsjs to stall\n  hls.currentLevel = 0;\n  // Set the quality back to auto so that we return to optimal quality\n  hls.currentLevel = -1;\n}\n\nfunction handleMediaError () {\n  if (autoRecoverError) {\n    let now = performance.now();\n    if (!window.recoverDecodingErrorDate || (now - window.recoverDecodingErrorDate) > 3000) {\n      window.recoverDecodingErrorDate = performance.now();\n      $('#statusOut').append(', trying to recover media error.');\n      hls.recoverMediaError();\n    } else {\n      if (!window.recoverSwapAudioCodecDate || (now - window.recoverSwapAudioCodecDate) > 3000) {\n        window.recoverSwapAudioCodecDate = performance.now();\n        $('#statusOut').append(', trying to swap audio codec and recover media error.');\n        hls.swapAudioCodec();\n        hls.recoverMediaError();\n      } else {\n        $('#statusOut').append(', cannot recover. Last media error recovery failed.');\n      }\n    }\n  }\n}\n\nfunction timeRangesToString (r) {\n  let log = '';\n  for (let i = 0; i < r.length; i++) {\n    log += '[' + r.start(i) + ', ' + r.end(i) + ']';\n    log += ' ';\n  }\n  return log;\n}\n\nfunction checkBuffer () {\n  let v = $('#video')[0];\n  let canvas = $('#bufferedCanvas')[0];\n  let ctx = canvas.getContext('2d');\n  let r = v.buffered;\n  let bufferingDuration;\n  ctx.fillStyle = 'black';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = 'gray';\n  if (r) {\n    if (!canvas.width || canvas.width !== v.clientWidth) {\n      canvas.width = v.clientWidth;\n    }\n\n    let pos = v.currentTime;\n    let bufferLen = 0;\n    for (let i = 0; i < r.length; i++) {\n      let start = r.start(i) / v.duration * canvas.width;\n      let end = r.end(i) / v.duration * canvas.width;\n      ctx.fillRect(start, 3, Math.max(2, end - start), 10);\n      if (pos >= r.start(i) && pos < r.end(i)) {\n        // play position is inside this buffer TimeRange, retrieve end of buffer position and buffer length\n        bufferLen = r.end(i) - pos;\n      }\n    }\n    // check if we are in buffering / or playback ended state\n    if (bufferLen <= 0.1 && v.paused === false && (pos - lastStartPosition) > 0.5) {\n      // don't create buffering event if we are at the end of the playlist, don't report ended for live playlist\n      if (lastDuration - pos <= 0.5 && events.isLive === false) {\n      } else {\n        // we are not at the end of the playlist ... real buffering\n        if (bufferingIdx !== -1) {\n          bufferingDuration = performance.now() - events.t0 - events.video[bufferingIdx].time;\n          events.video[bufferingIdx].duration = bufferingDuration;\n          events.video[bufferingIdx].name = bufferingDuration;\n        } else {\n          events.video.push({\n            type: 'buffering',\n            time: performance.now() - events.t0\n          });\n          trimEventHistory();\n          // we are in buffering state\n          bufferingIdx = events.video.length - 1;\n        }\n      }\n    }\n\n    if (bufferLen > 0.1 && bufferingIdx !== -1) {\n      bufferingDuration = performance.now() - events.t0 - events.video[bufferingIdx].time;\n      events.video[bufferingIdx].duration = bufferingDuration;\n      events.video[bufferingIdx].name = bufferingDuration;\n      // we are out of buffering state\n      bufferingIdx = -1;\n    }\n\n    // update buffer/position for current Time\n    let event = {\n      time: performance.now() - events.t0,\n      buffer: Math.round(bufferLen * 1000),\n      pos: Math.round(pos * 1000)\n    };\n    let bufEvents = events.buffer; let bufEventLen = bufEvents.length;\n    if (bufEventLen > 1) {\n      let event0 = bufEvents[bufEventLen - 2]; let event1 = bufEvents[bufEventLen - 1];\n      let slopeBuf0 = (event0.buffer - event1.buffer) / (event0.time - event1.time);\n      let slopeBuf1 = (event1.buffer - event.buffer) / (event1.time - event.time);\n\n      let slopePos0 = (event0.pos - event1.pos) / (event0.time - event1.time);\n      let slopePos1 = (event1.pos - event.pos) / (event1.time - event.time);\n      // compute slopes. if less than 30% difference, remove event1\n      if ((slopeBuf0 === slopeBuf1 || Math.abs(slopeBuf0 / slopeBuf1 - 1) <= 0.3) &&\n           (slopePos0 === slopePos1 || Math.abs(slopePos0 / slopePos1 - 1) <= 0.3)) {\n        bufEvents.pop();\n      }\n    }\n    events.buffer.push(event);\n    trimEventHistory();\n    window.refreshCanvas();\n\n    let log = 'Duration: ' +\n              v.duration + '\\n' +\n              'Buffered: ' +\n              timeRangesToString(v.buffered) + '\\n' +\n              'Seekable: ' +\n              timeRangesToString(v.seekable) + '\\n' +\n              'Played: ' +\n              timeRangesToString(v.played) + '\\n';\n\n    if (hls.media) {\n      for (let type in tracks) {\n        log += 'Buffer for ' + type + ' contains: ' + timeRangesToString(tracks[type].buffer.buffered) + '\\n';\n      }\n\n      const videoPlaybackQuality = v.getVideoPlaybackQuality;\n      if (videoPlaybackQuality && typeof (videoPlaybackQuality) === typeof (Function)) {\n        log += 'Dropped frames: ' + v.getVideoPlaybackQuality().droppedVideoFrames + '\\n';\n        log += 'Corrupted frames:' + v.getVideoPlaybackQuality().corruptedVideoFrames + '\\n';\n      } else if (v.webkitDroppedFrameCount) {\n        log += 'Dropped frames:' + v.webkitDroppedFrameCount + '\\n';\n      }\n    }\n    $('#bufferedOut').text(log);\n\n    $('#statisticsOut').text(JSON.stringify(sortObject(stats), null, '\\t'));\n\n    ctx.fillStyle = 'blue';\n\n    const x = v.currentTime / v.duration * canvas.width;\n    ctx.fillRect(x, 0, 2, 15);\n  }\n}\n\nfunction showCanvas () {\n  window.showMetrics();\n  $('#bufferedOut').show();\n  $('#bufferedCanvas').show();\n}\n\nfunction hideCanvas () {\n  window.hideMetrics();\n  $('#bufferedOut').hide();\n  $('#bufferedCanvas').hide();\n}\n\nfunction getMetrics () {\n  let json = JSON.stringify(events);\n  let jsonpacked = window.jsonpack.pack(json);\n  // console.log('packing JSON from ' + json.length + ' to ' + jsonpacked.length + ' bytes');\n  return btoa(jsonpacked);\n}\n\nfunction copyMetricsToClipBoard () {\n  copyTextToClipboard(getMetrics());\n}\n\nfunction goToMetrics () {\n  let url = document.URL;\n  url = url.substr(0, url.lastIndexOf('/') + 1) + 'metrics.html';\n  window.open(url, '_blank');\n}\n\nfunction goToMetricsPermaLink () {\n  let url = document.URL;\n  let b64 = getMetrics();\n  url = url.substr(0, url.lastIndexOf('/') + 1) + 'metrics.html#data=' + b64;\n  window.open(url, '_blank');\n}\n\nfunction minsecs (ts) {\n  let m = Math.floor(Math.floor(ts % 3600) / 60);\n  let s = Math.floor(ts % 60);\n  return m + ':' + (s < 10 ? '0' : '') + s;\n}\n\nfunction onClickBufferedRange (event) {\n  let canvas = $('#bufferedCanvas')[0];\n  let v = $('#video')[0];\n  let target = (event.clientX - canvas.offsetLeft) / canvas.width * v.duration;\n  v.currentTime = target;\n}\n\nfunction updateLevelInfo () {\n  if (!hls.levels) {\n    return;\n  }\n\n  let button_template = '<button type=\"button\" class=\"btn btn-sm ';\n  let button_enabled = 'btn-primary\" ';\n  let button_disabled = 'btn-success\" ';\n\n  let html1 = button_template;\n  if (hls.autoLevelEnabled) {\n    html1 += button_enabled;\n  } else {\n    html1 += button_disabled;\n  }\n\n  html1 += 'onclick=\"hls.currentLevel=-1\">auto</button>';\n\n  let html2 = button_template;\n  if (hls.autoLevelEnabled) {\n    html2 += button_enabled;\n  } else {\n    html2 += button_disabled;\n  }\n\n  html2 += 'onclick=\"hls.loadLevel=-1\">auto</button>';\n\n  let html3 = button_template;\n  if (hls.autoLevelCapping === -1) {\n    html3 += button_enabled;\n  } else {\n    html3 += button_disabled;\n  }\n\n  html3 += 'onclick=\"levelCapping=hls.autoLevelCapping=-1;updateLevelInfo();onDemoConfigChanged();\">auto</button>';\n\n  let html4 = button_template;\n  if (hls.autoLevelEnabled) {\n    html4 += button_enabled;\n  } else {\n    html4 += button_disabled;\n  }\n\n  html4 += 'onclick=\"hls.nextLevel=-1\">auto</button>';\n\n  for (let i = 0; i < hls.levels.length; i++) {\n    html1 += button_template;\n    if (hls.currentLevel === i) {\n      html1 += button_enabled;\n    } else {\n      html1 += button_disabled;\n    }\n\n    let levelName = i;\n    let label = level2label(i);\n    if (label) {\n      levelName += ' (' + level2label(i) + 'p)';\n    }\n\n    html1 += 'onclick=\"hls.currentLevel=' + i + '\">' + levelName + '</button>';\n\n    html2 += button_template;\n    if (hls.loadLevel === i) {\n      html2 += button_enabled;\n    } else {\n      html2 += button_disabled;\n    }\n\n    html2 += 'onclick=\"hls.loadLevel=' + i + '\">' + levelName + '</button>';\n\n    html3 += button_template;\n    if (hls.autoLevelCapping === i) {\n      html3 += button_enabled;\n    } else {\n      html3 += button_disabled;\n    }\n\n    html3 += 'onclick=\"levelCapping=hls.autoLevelCapping=' + i + ';updateLevelInfo();onDemoConfigChanged();\">' + levelName + '</button>';\n\n    html4 += button_template;\n    if (hls.nextLevel === i) {\n      html4 += button_enabled;\n    } else {\n      html4 += button_disabled;\n    }\n\n    html4 += 'onclick=\"hls.nextLevel=' + i + '\">' + levelName + '</button>';\n  }\n\n  let v = $('#video')[0];\n\n  if (v.videoWidth && v.videoHeight) {\n    $('#currentResolution').html(v.videoWidth + ' x ' + v.videoHeight);\n  }\n\n  if ($('#currentLevelControl').html() !== html1) {\n    $('#currentLevelControl').html(html1);\n  }\n\n  if ($('#loadLevelControl').html() !== html2) {\n    $('#loadLevelControl').html(html2);\n  }\n\n  if ($('#levelCappingControl').html() !== html3) {\n    $('#levelCappingControl').html(html3);\n  }\n\n  if ($('#nextLevelControl').html() !== html4) {\n    $('#nextLevelControl').html(html4);\n  }\n}\n\nfunction updateAudioTrackInfo () {\n  let button_template = '<button type=\"button\" class=\"btn btn-sm ';\n  let button_enabled = 'btn-primary\" ';\n  let button_disabled = 'btn-success\" ';\n  let html1 = '';\n  let audioTrackId = hls.audioTrack; let len = hls.audioTracks.length;\n\n  for (let i = 0; i < len; i++) {\n    html1 += button_template;\n    if (audioTrackId === i) {\n      html1 += button_enabled;\n    } else {\n      html1 += button_disabled;\n    }\n\n    html1 += 'onclick=\"hls.audioTrack=' + i + '\">' + hls.audioTracks[i].name + '</button>';\n  }\n  $('#audioTrackControl').html(html1);\n}\n\nfunction level2label (index) {\n  if (hls && hls.levels.length - 1 >= index) {\n    let level = hls.levels[index];\n    if (level.name) {\n      return level.name;\n    } else {\n      if (level.height) {\n        return (level.height + 'p / ' + Math.round(level.bitrate / 1024) + 'kb');\n      } else {\n        if (level.bitrate) {\n          return (Math.round(level.bitrate / 1024) + 'kb');\n        } else {\n          return null;\n        }\n      }\n    }\n  }\n}\n\nfunction getDemoConfigPropOrDefault (propName, defaultVal) {\n  return typeof demoConfig[propName] !== 'undefined' ? demoConfig[propName] : defaultVal;\n}\n\nfunction getURLParam (sParam, defaultValue) {\n  let sPageURL = window.location.search.substring(1);\n  let sURLVariables = sPageURL.split('&');\n  for (let i = 0; i < sURLVariables.length; i++) {\n    let sParameterName = sURLVariables[i].split('=');\n    if (sParameterName[0] === sParam) {\n      return sParameterName[1] === 'undefined' ? undefined : sParameterName[1] === 'false' ? false : sParameterName[1];\n    }\n  }\n  return defaultValue;\n}\n\nfunction onDemoConfigChanged () {\n  demoConfig = {\n    enableStreaming,\n    autoRecoverError,\n    dumpfMP4,\n    levelCapping,\n    limitMetrics\n  };\n\n  if (configPersistenceEnabled) {\n    persistEditorValue();\n  }\n\n  const serializedDemoConfig = btoa(JSON.stringify(demoConfig));\n  const baseURL = document.URL.split('?')[0];\n  const streamURL = $('#streamURL').val();\n  const permalinkURL = `${baseURL}?src=${encodeURIComponent(streamURL)}&demoConfig=${serializedDemoConfig}`;\n\n  $('#StreamPermalink').html(`<a href=\"${permalinkURL}\">${permalinkURL}</a>`);\n}\n\nfunction onConfigPersistenceChanged (event) {\n  configPersistenceEnabled = event.target.checked;\n  localStorage.setItem(STORAGE_KEYS.Editor_Persistence, JSON.stringify(configPersistenceEnabled));\n\n  if (configPersistenceEnabled) {\n    persistEditorValue();\n  } else {\n    localStorage.removeItem(STORAGE_KEYS.Hls_Config);\n  }\n}\n\nfunction getPersistedHlsConfig () {\n  let value = localStorage.getItem(STORAGE_KEYS.Hls_Config);\n\n  if (value === null) {\n    return value;\n  }\n\n  try {\n    value = JSON.parse(value);\n  } catch (e) {\n    console.warn('[getPersistedHlsConfig] could not hls config json', e);\n    value = {};\n  }\n\n  return value;\n}\n\nfunction arrayConcat (inputArray) {\n  let totalLength = inputArray.reduce(function (prev, cur) {\n    return prev + cur.length;\n  }, 0);\n  let result = new Uint8Array(totalLength);\n  let offset = 0;\n  inputArray.forEach(function (element) {\n    result.set(element, offset);\n    offset += element.length;\n  });\n  return result;\n}\n\nfunction appendLog (textElId, message) {\n  const el = $('#' + textElId);\n  let logText = el.text();\n  if (logText.length) {\n    logText += '\\n';\n  }\n  const timestamp = (Date.now() - startTime) / 1000;\n  const newMessage = timestamp + ' | ' + message;\n  logText += newMessage;\n  // update\n  el.text(logText);\n}\n\nfunction logStatus (message) {\n  appendLog('statusOut', message);\n}\n\nfunction logError (message) {\n  appendLog('errorOut', message);\n}\n\n","/**\n * Create test stream\n * @param {string} url\n * @param {string} description\n * @param {boolean} [live]\n * @param {boolean} [abr]\n * @param {string[]} [blacklist_ua]\n * @returns {{url: string, description: string, live: boolean, abr: boolean, blacklist_ua: string[]}}\n */\nfunction createTestStream (url, description, live = false, abr = true, blacklist_ua = []) {\n  return {\n    url,\n    description,\n    live,\n    abr,\n    blacklist_ua\n  };\n}\n\n/**\n * @param {Object} target\n * @param {Object} [config]\n * @returns {{url: string, description: string, live: boolean, abr: boolean, blacklist_ua: string[]}}\n */\nfunction createTestStreamWithConfig (target, config) {\n  if (typeof target !== 'object') {\n    throw new Error('target should be object');\n  }\n\n  const testStream = createTestStream(target.url, target.description, target.live, target.abr, target.blacklist_ua);\n\n  testStream.config = config;\n\n  return testStream;\n}\n\nmodule.exports = {\n  bbb: createTestStreamWithConfig({\n    url: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8',\n    description: 'Big Buck Bunny - adaptive qualities'\n  },\n  {\n    // try to workaround test failing because of slow seek on Chrome/Win10\n    nudgeMaxRetry: 5\n  }\n  ),\n  borat: {\n  \turl: 'https://github.com/sabaroof/PIPIM/tree/master/hls.js/tests/borat_hsl_playlist.m3u8',\n  \tdescription: 'Borat mwi dzikuje',\n  \tlive: false,\n  \tabr: false,\n  \tblacklist_ua: [],\n  },\n  LabScreenCap1: {\n  \turl: 'https://github.com/sabaroof/PIPIM/tree/master/hls.js/tests/hsl_playlist1.m3u8',\n  \tdescription: 'Pierwszy screencap z projektu',\n  \tlive: false,\n  \tabr: false,\n  \tblacklist_ua: [],\n  \t},\n  LabScreenCap2: {\n  \turl: 'https://github.com/sabaroof/PIPIM/tree/master/hls.js/tests/hsl_playlist2.m3u8',\n  \tdescription: 'Drugi screencap z projektu',\n  \tlive: false,\n  \tabr: false,\n  \tblacklist_ua: [],\n  },\n};\n"],"sourceRoot":""}